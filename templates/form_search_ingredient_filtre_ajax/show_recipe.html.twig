{% extends "base.html.twig" %}

{% block body %}
{% include 'navigation.html.twig' %}
<style>
.blue-color {
    color:blue;
}
</style>

<h1> Title: {{recipe[0].titre}}</h1>


<span id="heart_like {{recipe[0].id}}" data-id={{recipe[0].id}} class="bi bi-heart-fill blue-color"></span>

<h3> Ingredients: </h3>
<ul>

    {% for ingRec in ingRecette %}
        <li> {{ingRec.nom}}: {{ingRec.quantityMeasure}}</li>
    {% endfor %}

</ul>

    
<h3> Instructions: </h3>
<p>{{recipe[0].instruction}}</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/axios.min.js" integrity="sha512-emSwuKiMyYedRwflbZB2ghzX8Cw8fmNVgZ6yQNNXXagFzFOaQmbvQ1vmDkddHjm5AITcBIZfC7k4ShQSjgPAmQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>

let likeButton = document.getElementById("heart_like {{recipe[0].id}}");

// Check if the color preference is already stored in localStorage
if (localStorage.getItem("buttonColor") === "red") {
  likeButton.style.color = "rgb(255, 0, 0)";
}

likeButton.addEventListener('click', function(event) {
  let styles = getComputedStyle(likeButton).color;
  let btnClique=event.target;
    let formLike= new FormData();
    formLike.append("id", btnClique.dataset.id);

  if (styles === "rgb(0, 0, 255)") {
    likeButton.style.color = "rgb(255, 0, 0)";
    localStorage.setItem("buttonColor", "red"); // Store the color preference in localStorage
     

    axios.post ("/recipe/like", formLike, { headers: {
        'Content-Type': 'multipart/form-data',  },
    })
    .then ((response)=>{
        //alert("hello du if");
    
    })
    .catch((error)=>{
        console.log("La reponse de la requete POst:", error);

    })
  } else {
    likeButton.style.color = "rgb(0, 0, 255)";
    localStorage.removeItem("buttonColor"); // Remove the color preference from localStorage

    axios.post ("/recipe/unlike", formLike, { headers: {
        'Content-Type': 'multipart/form-data',  },
    })
    .then ((response)=>{
        //alert("hello du else");
    })
    .catch((error)=>{
        console.log("La reponse de la requete POst:", error);

    })
  }
});

</script>


{% endblock %}